# Эксплуатация BoF. Классическое переполнение буфера без обхода защитных механизмов DEP/ASLR.
Веб-интерфейс у сервера отсутствует, начнем со сканирования Nmap и увидим доступные нам порты
![2025-08-27 16 24 12](https://github.com/user-attachments/assets/66fa8963-943b-45b4-90a7-7c9187c239e2)
Перебираем порты и успешно подключаемся только к 3301 порту, с ним и будем работать.Все вводимые данные на сервере фильтруются, прописываем HELP и видим доступные нам команды которые проходят
<img width="832" height="619" alt="Снимок экрана 2025-08-27 в 16 30 00" src="https://github.com/user-attachments/assets/badaa2a0-0185-4fc4-9398-5a676287221c" />
Так как у нас фильтруются все строки кроме разрешенных, будем передавать в буфер строку + нагрузку. Напишем небольшую программу на пайтоне, где создадим лист и будем передавать элементы каждого разрешенного значения в цикле, чтобы понять при каком элементе происходит переполнение буфера. Так же создадим паттерн на 2500 байт используя msf pattern для создания проверочного буфера в нашем коде, сам код выглядит вот так
<img width="830" height="255" alt="Снимок экрана 2025-08-27 в 16 35 57" src="https://github.com/user-attachments/assets/cd5526da-3953-4242-883a-0904ab54f746" />
Сервер падает на значении “GTER ”, будем проверять offset используя msf-pattern со значением нашего EIP и видим, что буфер дает нам всего 147 байт, из опыта знаем, шелл нагрузка созданная через msf занимает 350-385 байт, чего не хватит для использования шелл кода
<img width="825" height="522" alt="Снимок экрана 2025-08-27 в 16 37 25" src="https://github.com/user-attachments/assets/b2c1fc6b-37c7-44dd-98ab-19c085589b4f" />
<img width="830" height="143" alt="Снимок экрана 2025-08-27 в 16 37 56" src="https://github.com/user-attachments/assets/1df58165-18e5-4909-9608-9d012d1c79e5" />
Продолжаем искать значения с допустимым размером буфера и останавливаемся на строке «BRUN » и так же проверяем на offset, где видим значение в 2007 байт, чего нам хватит на размещение шелл кода
<img width="616" height="82" alt="Снимок экрана 2025-08-27 в 16 39 03" src="https://github.com/user-attachments/assets/fbfaa323-ea5e-47a9-908c-68df6678aa1d" />
Начну написание нашего фаззера, нужно убедиться, что значение 2007 действительно корректное и имеется контроль EIP, подам значение “\x42\x42\x42\x42” и должен увидеть его в регистре EIP
<img width="646" height="293" alt="Снимок экрана 2025-08-27 в 16 40 37" src="https://github.com/user-attachments/assets/7aa1b9fb-217e-4736-830f-1bda207617fe" />
Фиксирую, что контролирую значение EIP так как туда попала проверочная строка с 4 символами “B”. Важно отметить значение регистра ESP, так как именно в него и буду передавать полезную нагрузку созданную через msfvenom
<img width="292" height="279" alt="Снимок экрана 2025-08-27 в 16 42 18" src="https://github.com/user-attachments/assets/0449fe03-3f2c-488c-a573-d8a6085a304e" />

